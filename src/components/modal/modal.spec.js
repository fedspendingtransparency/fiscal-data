import React from 'react';
import { fireEvent, render } from '@testing-library/react';

import Modal from './modal';

describe('Modal component', () => {
  it('renders a modal component with a content div inside', () => {
    const onClose = jest.fn();
    const { getByTestId } = render(<Modal open onClose={onClose} />);

    expect(getByTestId('modal')).toBeDefined();
    expect(getByTestId('content')).toBeDefined();
  });

  it('closes the default modal on backdrop click', () => {
    const onClose = jest.fn();
    const { getByTestId } = render(<Modal open onClose={onClose} />);

    getByTestId('backdrop').click();
    expect(onClose).toHaveBeenCalled();
  });

  it('closes the default modal on Esc key press', () => {
    const onClose = jest.fn();
    const { getByTestId } = render(<Modal open onClose={onClose} />);

    fireEvent.keyDown(getByTestId('modal'), { key: 'Escape', code: 'Escape' });
    expect(onClose).toHaveBeenCalled();
  });

  it('does not close the modal on backdrop click when disabled', () => {
    const onClose = jest.fn();
    const { getByTestId } = render(<Modal open onClose={onClose} disableBackdropClick />);

    getByTestId('backdrop').click();
    expect(onClose).not.toHaveBeenCalled();
  });

  it('does not close the modal on Esc key press when disabled', () => {
    const onClose = jest.fn();
    const { getByTestId } = render(<Modal open onClose={onClose} disableEscapeKey />);

    fireEvent.keyDown(getByTestId('modal'), { key: 'Escape', code: 'Escape' });
    expect(onClose).not.toHaveBeenCalled();
  });
});
